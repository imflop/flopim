<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <meta content="fl" name="author">

    <title>flop → { td: a lightweight cli todo applications }</title>

    <!-- Style's -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/bootstrap.overload.css">
    

    

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Images & icons -->
</head>
<body>
    <nav class="navbar navbar-inverse navbar-static-top" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="index.html">flop page's</a>
            </div>
            <div class="collapse navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="list.html">archive</a></li>
                    <li><a href="projects.html">projects</a></li>
                    <li><a href="about.html">about</a></li>
                    <li>
                        <a href="https://twitter.com/imflop" class="social-link" target="_blank" data-toggle="tooltip" data-placement="bottom" data-original-title="Twitter" rel="tooltip"><i class="fa fa-twitter-square"></i></a>
                    </li>
                    <li>
                        <a href="https://github.com/imflop" class="social-link" target="_blank" data-toggle="tooltip" data-placement="bottom" data-original-title="Github" rel="tooltip"><i class="fa fa-github-square"></i></a>
                    </li>
                    <li>
                        <a href="https://bitbucket.org/flop" class="social-link" target="_blank" data-toggle="tooltip" data-placement="bottom" data-original-title="Bitbucket" rel="tooltip"><i class="fa fa-bitbucket-square"></i></a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <div class="container">
        <div class="row mgb-60">
            <div class="col-sm-12">
                <article class="entry">
                    <div class="entry-header">
                        <h1 class="entry-title">td: a lightweight cli todo applications</h1>
                    </div>
                    <div class="entry-meta">
                        <span class="author">
                            <a rel="author" title="View all posts by Oleg Makarov" href="#">fl</a>
                        </span>
                        <span class="post-date">
                            <time class="entry-date" datetime="2014-11-04T16:09:46+00:00">15 Ноября, 2014</time>
                        </span>
                    </div>
                    <div class="entry-content">
                        <p class="p1">Повседневная практика показывает, что дальнейшее развитие различных форм деятельности позволяет оценить значение соответствующий условий активизации. Идейные соображения высшего порядка, а также новая модель организационной деятельности играет важную роль в формировании системы обучения кадров, соответствует насущным потребностям.</p>
                        <img src="img/uploads/scrnsht.png" alt="" class="img-responsive">
                        <p class="p1">Значимость этих проблем настолько очевидна, что реализация намеченных плановых заданий обеспечивает широкому кругу (специалистов) участие в формировании позиций, занимаемых участниками в отношении поставленных задач.</p>
                            <pre><code>#!/usr/bin/env python
#-*- coding:utf-8 -*-

import os
import sys
import base64
try:
    import json
except ImportError:
    import simplejson as json
from platform import system


TD_LIST_NAME = "td"
TD_FOLDER_NAME = "/.td/"


def _get_appdata_path():
    import ctypes
    from ctypes import wintypes, windll
    CSIDL_APPDATA = 26
    _SHGetFolderPath = windll.shell32.SHGetFolderPathW
    _SHGetFolderPath.argtypes = [wintypes.HWND,
                                 ctypes.c_int,
                                 wintypes.HANDLE,
                                 wintypes.DWORD,
                                 wintypes.LPCWSTR]
    path_buf = wintypes.create_unicode_buffer(wintypes.MAX_PATH)
    result = _SHGetFolderPath(0, CSIDL_APPDATA, 0, 0, path_buf)
    return path_buf.value


def _dropbox_home():
    _system = system()
    if _system in ('Windows', 'cli'):
        host_db_path = os.path.join(_get_appdata_path(), 'Dropbox', 'host.db')
    elif _system in ('Linux', 'Darwin'):
        host_db_path = os.path.expanduser('~''/.dropbox''/host.db')
    else:
        raise RuntimeError('Unknown system={}'.format(_system))
    if not os.path.exists(host_db_path):
        raise RuntimeError('Dropbox path does not exists'.format(_system))

    with open(host_db_path, 'r') as f:
        data = f.read().split()
    return base64.b64decode(data[1])


def create_dir():
    json_folder = _dropbox_home() + TD_FOLDER_NAME
    try:
        os.makedirs(json_folder)
    except OSError as e:
        if e.errno == 17: # folder exists
            pass
        else:
            raise e
    create_list()


def create_list():
    try:
        json_file = open(get_list_filename(TD_LIST_NAME), "r")
        json.loads(json_file.read())
    except IOError as e:
        if e.errno == 2:  # no such file, create file
            json_file = open(get_list_filename(TD_LIST_NAME), "w")
            json_file.write("{}")
            json_file.close()


def get_list_filename(list_name):
    json_folder = _dropbox_home() + TD_FOLDER_NAME
    filename = json_folder + list_name.lower() + ".json"
    return filename


def add():
    text = ' '.join(sys.argv[1:])
    #save(text)
    read(text)


def save(t, _id):
    json_file = open(get_list_filename(TD_LIST_NAME), "w")
    data = json.load(json_file)
    print "========================================"
    print data
    json_list = json.dumps({
        "id": _id,
        "item": t
    })
    #json_file.write(json_list)
    json_file.close()
    #read()


def read(t):
    json_file = open(get_list_filename(TD_LIST_NAME), "r")
    data = json.load(json_file)
    tmp_data = data['tasks'][-1:]
    tmp_id = 0
    for t in tmp_data:
        tmp_id = int(t['id'])
    tmp_id += 1
    print tmp_id
    save(t, tmp_id)

    for d in data['tasks']:
        print "%s: %s" % (d['id'], d['item'])


def run():
    try:
        if 3 > len(sys.argv):
            pass
        else:
            add()
    except Exception, e:
        raise e
    #create_dir()


if __name__ == '__main__':
    run()</code></pre>
                        <p class="p1">Идейные соображения высшего порядка, а также укрепление и развитие структуры обеспечивает широкому кругу (специалистов) участие в формировании систем массового участия. Задача организации, в особенности же рамки и место обучения кадров позволяет оценить значение позиций, занимаемых участниками в отношении поставленных задач. Таким образом дальнейшее развитие различных форм деятельности играет важную роль в формировании модели развития. Товарищи! новая модель организационной деятельности влечет за собой процесс внедрения и модернизации направлений прогрессивного развития. Равным образом сложившаяся структура организации позволяет оценить значение форм развития. С другой стороны реализация намеченных плановых заданий влечет за собой процесс внедрения и модернизации модели развития.</p>
                    </div>
                </article>
                <div class="navigation-post">
                    <div class="nav-previous">
                        <a href="#" rel="prev">&larr;&nbsp;Super puper previous post with links</a>
                    </div>
                    <div class="nav-next">
                        <a href="#" rel="next">Super duper next post with links тестируем большое количество символов в заголовке поста&nbsp;&rarr;</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <footer class="footer">
        <div class="container">
            <p>my footer there</p>
        </div>
    </footer>


    <!-- Latest compiled and minified JavaScript -->
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
    <!-- Font's -->
    <link href='http://fonts.googleapis.com/css?family=PT+Serif&subset=cyrillic-ext,latin' rel='stylesheet' type='text/css'>
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel='stylesheet' type='text/css'>
    <script type="text/javascript">
        $(function() {
            $("[rel='tooltip']").tooltip();
        });
    </script>
</body>
</html>
